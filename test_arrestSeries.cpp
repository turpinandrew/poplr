
#include <iostream>
#include <string>
#include <json/reader.h>
#include <json/value.h>
#include <fstream>

#include "poplr_arrest.hpp"
#include "read_json.hpp"
#include "arrestSeries.hpp"

using namespace std;

Series s1 {
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35}
};

Series a1 {
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35}
};

    // end in Red
Series s2 {
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, Y(17), Y(17), Y(17), O(17), R(), R()}
};

Series a2 {
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35}
};

    // all Yellow
Series s3 {
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10)}
};

Series a3 {
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35}
};

    // degenerate
Series s4 {
    {35, Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10)},
    {35, Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10)},
    {35, Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10)},
    {35, Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10)},
    {35, Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10), Y(10)}
};

Series a4 {};

    // G G G Y Y Y 
Series s5 {
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {16, 16, 16, 16, 16, Y(16), Y(16), Y(16), Y(16), Y(16)},
    {30, 28, 26, 24, 22, Y(14), Y(14), Y(14), Y(14), Y(14)},
    {30, 28, 26, 24, Y(14), Y(14), Y(14), Y(14), Y(14), Y(14)},
    {30, 28, 26, Y(14), Y(14), Y(14), Y(14), Y(14), Y(14), Y(14)},
    {30, 28, Y(14), Y(14), Y(14), Y(14), Y(14), Y(14), Y(14), Y(14)},
    {30, Y(14), Y(14), Y(14), Y(14), Y(14), Y(14), Y(14), Y(14), Y(14)}
};

Series a5 {
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35},
    {35, 35, 35, 35, 35, 35, 35, 35, 35, 35}
};

Series s6 {
    {30, 30, 30, Y(14), O(14), -999},
    {25, 25, 25, Y(14), O(14), -999},
    {20, 20, 20, Y(14), O(14), -999},
    {15, 15, 15, Y(14), O(14), -999},
    {10, 10, 10, Y(14), O(14), -999}
};

Series a7_stable_21_e101_r1 = {
  {  25.2500,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410},
  {  22.0682,  17.0677,  21.2230,  11.2733,  24.7591,  22.0360,  28.7629,  23.6009,  17.0347,  18.6527,  26.6499,  16.1782},
  {  24.9259,-112.0156,-112.0156,-112.0156,-112.0156,-112.0156,-112.0156,-112.0156,-112.0156,-112.0156,-112.0156,-112.0156},
  {  25.7968,  26.8750,  27.2849,  24.4909,  25.7968,  28.1244,  25.2500,  22.0360,  25.9485,  24.7572,  26.1599,  26.5921},
  {  22.9376,  16.1782,  30.1011,  30.1011,  20.8235,  27.2849,  33.1565,  25.9485,  18.2311,  24.4909,  23.2762,  18.2311},
  {  22.7690,  25.9485,  24.4909,  30.1398,  24.6636,  25.9485,  26.5921,  24.6636,  25.8902,  25.9485,  17.0347,  18.2311},
  {  25.2500,  25.9485,  24.4909,  28.1244,  33.1565,  24.4909,  26.0985,  30.1011,  28.7629,  25.7018,  26.1599,  30.1011},
  {  22.8387,  28.1244,  22.7690,  26.1599,  27.6529,  18.2311,  26.5921,  28.1244,  18.2311,  18.2311,  18.2311,  28.7629},
  {  23.6009,  27.2849,  15.8378,  22.8387,  23.9373,  23.2351,  30.9964,  25.2500,  30.9964,  23.2351,  22.7690,  30.9964},
  {  27.2849,  30.1011,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410,-114.6410},
  {  27.2849,  12.3794,  24.9259,  15.9625,  13.1613,  16.7070,  12.6871,  20.5077,  24.4909,  17.0677,  30.9964,  25.1069},
  {  28.7629,  17.1913,  30.9964,  17.0677,  23.6009,  20.7474,  23.6009,  24.6636,  17.0347,  15.7726,  10.7447,  17.0677},
  {-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260},
  {  17.0878,   7.7520,  24.4909,  22.9436,  18.2311,  11.8247,  17.5191,  18.2311,  24.0696,  24.6636,   9.0223,  19.6088},
  {  10.0799,  16.1782,  14.3871,  16.1073,  16.2469,  25.9485,  24.5205,  22.9669,  11.8742,-113.1998,-113.1998,-113.1998},
  {  20.7474,-112.2319,-112.2319,-112.2319,-112.2319,-112.2319,-112.2319,-112.2319,-112.2319,-112.2319,-112.2319,-112.2319},
  {  22.8387,  15.7726,  17.0677,  16.3946,  17.0677,  22.1201,  14.8890,  26.6499,  24.0696,  18.6527,  25.9485,  22.8387},
  {  24.0696,  22.8387,  22.8387,  24.0696,  20.6300,  19.6088,  24.4909,  14.5603,  25.2500,  25.9485,  23.6866,  22.8387},
  {  15.4363,  18.9521,  16.1782,  15.6878,  18.2311,  16.0244,  24.6636,  26.9530,  26.5921,  26.0395,  16.1782,  26.5921},
  {  16.3946,  28.7629,  24.7572,  21.2230,  16.1782,  21.2230,  24.4909,  24.4909,  23.8218,  25.1069,  23.6009,  22.0360},
  {  25.2500,  25.2500,  20.7474,  22.7017,  27.6529,  22.8219,  21.2230,  19.5588,  23.6009,  23.8218,  22.0360,  19.6088},
  {  19.5588,  16.3872,  19.5588,  14.8890,  28.7629,  16.5376,  24.6636,  25.9485,  23.2351,  21.6479,  23.6009,  20.0873},
  {  18.2311,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998},
  {  19.0307,  15.7726,  15.8019,  17.0677,  25.7018,  23.6009,  24.4909,  25.7968,  28.7629,  16.1782,-114.6410,-114.6410},
  {  17.0347,  28.7629,  26.5921,  30.1011,  30.1011,  32.4865,  20.5077,  14.3871,  17.1865,  18.0365,  27.6529,  18.2311},
  {  14.8890,  15.2506,  12.8747,-111.0786,-111.0786,-111.0786,-111.0786,-111.0786,-111.0786,-111.0786,-111.0786,-111.0786}, // !!
  {   5.8757,  13.1613,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385},
  {-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109},
  {  28.1244,-105.8723,-105.8723,-105.8723,-105.8723,-105.8723,-105.8723,-105.8723,-105.8723,-105.8723,-105.8723,-105.8723},
  {-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109},
  {-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998,-113.1998},
  {  16.3872,  19.6088,  18.9521,  19.6088,  17.9015,  15.4363,  25.7018,  30.1011,  16.1073,  14.3871,-114.1697,-114.1697},
  {  18.2311,  26.0985,  25.7018,  24.4909,  28.1301,  16.1782,  20.2171,  18.3376,  14.3871,  27.6529,  16.3946,  20.2164},
  {  32.4865,  22.8387,  19.6088,  26.5921,  24.6636,  27.2849,  25.9485,  25.2500,  26.6499,  19.6163,  27.2849,  24.9259},
  {  24.7572,  27.2849,  25.1069,  26.5921,  24.7572,  23.6009,  25.2500,  26.5921,  28.1244,  27.6529,  22.1028,  24.4909},
  {  25.9485,  17.5191,  16.1782,  18.3376,  18.8111,  26.1599,  23.6866,  20.3476,  28.7629,  23.2351,  24.4909,  15.2355},
  {  16.1782,  23.0316,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385,-114.8385},
  {  18.2311,  17.0677,  16.1782,  17.0442,  24.4909,  27.6529,  18.2311,  15.5183,  20.9824,  23.9373,  11.8658,  27.6529},
  {  15.2355,  17.0677,  16.3946,  26.6499,  18.2311,  18.3376,  24.0696,  20.8786,  30.5894,  21.2230,  14.3871,  19.6088},
  {  27.6529,  28.1244,  24.0696,  16.1782,  28.7629,  20.0873,  30.1011,  12.8327,  19.6579,  17.0372,  19.6088,  27.2849},
  {  16.5535,  16.0681,  13.1613,  26.9530,  18.2311,  28.1244,  18.6527,  16.1782,  12.6871,  11.2220,-112.2319,-112.2319},
  {-110.8717,-110.8717,-110.8717,-110.8717,-110.8717,-110.8717,-110.8717,-110.8717,-110.8717,-110.8717,-110.8717,-110.8717},
  {   1.6267,  28.7629,-103.6346,-203.6346,-103.6346,-203.6346,-103.6346,-203.6346,-103.6346,-103.6346,-103.6346,-103.6346},
  {  30.1011,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109},
  {-100.8231,-100.8231,-200.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231},
  {-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260,-107.3260},
  {  10.9196,   9.5040,  15.3734,  25.7968,  16.0255,  30.1011,  21.2230,-213.9857,-113.9857,-113.9857,-113.9857,-113.9857},
  {  16.3387,  22.1028,  23.2762,  33.1565,  23.2351,  15.2355,  26.9530,  24.4909,  19.6088,  22.8387,  25.8902,  19.6088},
  {  30.5894,  30.1011,  25.9485,  26.9530,  30.1011,  24.9259,  24.4909,  25.9485,  28.7629,  28.7629,  25.9485,  25.2500},
  {  24.5945,  25.7968,  27.6529,  27.2849,  22.8387,  21.2230,  26.5921,  24.1527,  28.1244,  23.6009,  25.9485,  28.1244},
  {  23.2351,  30.1011,  24.4909,  27.6529,  25.2500,  17.0347,  26.1599,  17.0677,  23.8218,  22.9436,  23.6009,  19.6088},
  {  15.8378,  15.2355,  25.7968,  23.6009,  16.7194,  22.8387,  25.2500,  16.1782,  18.2311,  21.9394,  16.3171,  21.2230}};

    Series a_a7_stable_21_e101_r1 = {
        {15.8378,15.2355,25.7968,23.6009,16.7194,22.8387,25.25,16.1782,18.2311,21.9394,16.3171,21.223},
        {22.0682,17.0677,21.223,11.2733,24.7591,22.036,28.7629,23.6009,17.0347,18.6527,26.6499,16.1782},
        {23.2351,30.1011,24.4909,27.6529,25.25,17.0347,26.1599,17.0677,23.8218,22.9436,23.6009,19.6088},
        {25.7968,26.875,27.2849,24.4909,25.7968,28.1244,25.25,22.036,25.9485,24.7572,26.1599,26.5921},
        {22.9376,16.1782,30.1011,30.1011,20.8235,27.2849,33.1565,25.9485,18.2311,24.4909,23.2762,18.2311},
        {22.769,25.9485,24.4909,30.1398,24.6636,25.9485,26.5921,24.6636,25.8902,25.9485,17.0347,18.2311},
        {25.25,25.9485,24.4909,28.1244,33.1565,24.4909,26.0985,30.1011,28.7629,25.7018,26.1599,30.1011},
        {22.8387,28.1244,22.769,26.1599,27.6529,18.2311,26.5921,28.1244,18.2311,18.2311,18.2311,28.7629},
        {23.6009,27.2849,15.8378,22.8387,23.9373,23.2351,30.9964,25.25,30.9964,23.2351,22.769,30.9964},
        {24.5945,25.7968,27.6529,27.2849,22.8387,21.223,26.5921,24.1527,28.1244,23.6009,25.9485,28.1244},
        {27.2849,12.3794,24.9259,15.9625,13.1613,16.707,12.6871,20.5077,24.4909,17.0677,30.9964,25.1069},
        {28.7629,17.1913,30.9964,17.0677,23.6009,20.7474,23.6009,24.6636,17.0347,15.7726,10.7447,17.0677},
        {30.5894,30.1011,25.9485,26.953,30.1011,24.9259,24.4909,25.9485,28.7629,28.7629,25.9485,25.25},
        {17.0878,7.752,24.4909,22.9436,18.2311,11.8247,17.5191,18.2311,24.0696,24.6636,9.0223,19.6088},
        {16.3387,22.1028,23.2762,33.1565,23.2351,15.2355,26.953,24.4909,19.6088,22.8387,25.8902,19.6088},
        {27.6529,28.1244,24.0696,16.1782,28.7629,20.0873,30.1011,12.8327,19.6579,17.0372,19.6088,27.2849},
        {22.8387,15.7726,17.0677,16.3946,17.0677,22.1201,14.889,26.6499,24.0696,18.6527,25.9485,22.8387},
        {24.0696,22.8387,22.8387,24.0696,20.63,19.6088,24.4909,14.5603,25.25,25.9485,23.6866,22.8387},
        {15.4363,18.9521,16.1782,15.6878,18.2311,16.0244,24.6636,26.953,26.5921,26.0395,16.1782,26.5921},
        {16.3946,28.7629,24.7572,21.223,16.1782,21.223,24.4909,24.4909,23.8218,25.1069,23.6009,22.036},
        {25.25,25.25,20.7474,22.7017,27.6529,22.8219,21.223,19.5588,23.6009,23.8218,22.036,19.6088},
        {19.5588,16.3872,19.5588,14.889,28.7629,16.5376,24.6636,25.9485,23.2351,21.6479,23.6009,20.0873},
        {15.2355,17.0677,16.3946,26.6499,18.2311,18.3376,24.0696,20.8786,30.5894,21.223,14.3871,19.6088},
        {18.2311,17.0677,16.1782,17.0442,24.4909,27.6529,18.2311,15.5183,20.9824,23.9373,11.8658,27.6529},
        {17.0347,28.7629,26.5921,30.1011,30.1011,32.4865,20.5077,14.3871,17.1865,18.0365,27.6529,18.2311},
        {25.9485,17.5191,16.1782,18.3376,18.8111,26.1599,23.6866,20.3476,28.7629,23.2351,24.4909,15.2355},
        {24.7572,27.2849,25.1069,26.5921,24.7572,23.6009,25.25,26.5921,28.1244,27.6529,22.1028,24.4909},
        {32.4865,22.8387,19.6088,26.5921,24.6636,27.2849,25.9485,25.25,26.6499,19.6163,27.2849,24.9259},
        {18.2311,26.0985,25.7018,24.4909,28.1301,16.1782,20.2171,18.3376,14.3871,27.6529,16.3946,20.2164}};

    double NaN = numeric_limits<double>::quiet_NaN();

    Series a7_stable_21_e125_r1 = {
        {23.8218,25.25,28.7629,21.223,23.6009,18.2556,21.223,24.4909,16.5376,32.4865,24.4909,18.3376},
        {26.0395,24.6636,23.2762,30.1011,25.25,28.7629,27.2849,25.9485,21.223,25.9485,23.6009,22.9669},
        {27.2849,25.25,25.25,24.4909,24.9259,27.6529,26.0985,22.0682,25.7018,24.4909,25.25,30.1011},
        {28.7629,28.1244,27.6529,27.2849,30.1011,27.2849,26.5921,30.9964,28.7629,27.6529,30.5894,30.1011},
        {24.4909,26.953,19.6088,25.9485,17.9015,30.9964,30.1011,25.9485,23.2351,4.1739,16.5376,25.8902},
        {-112.0189,-112.0189,-112.0189,-112.0189,-112.0189,-112.0189,-112.0189,-112.0189,-112.0189,-112.0189,-112.0189,-112.0189},
        {25.1069,19.6088,12.3794,10.2571,18.0365,16.2469,16.1782,20.2171,-107.4086,-107.4086,-107.4086,-107.4086},
        {1.0302,10.7447,-111.1314,-111.1314,-111.1314,-111.1314,-111.1314,-111.1314,-111.1314,-111.1314,-111.1314,-111.1314},
        {17.0677,-113.5203,-113.5203,-113.5203,-113.5203,-113.5203,-113.5203,-113.5203,-113.5203,-113.5203,-113.5203,-113.5203},
        {10.0034,7.752,16.1782,-105.9739,-105.9739,-105.9739,-105.9739,-105.9739,-105.9739,-105.9739,-105.9739,-105.9739},
        {18.2311,24.6823,30.1011,24.4909,22.8387,25.25,18.2556,23.8218,23.6824,22.8387,30.1011,21.223},
        {28.1244,26.5921,25.7018,26.0985,26.5921,26.5921,21.223,23.6009,23.6009,25.25,23.2351,24.4909},
        {25.9485,18.2311,25.7018,25.1069,24.4909,30.9964,17.0677,24.4909,26.5921,18.6527,28.7629,25.25},
        {27.6529,22.0929,30.5894,25.1069,27.2849,24.6636,24.4909,23.6009,27.6529,26.953,22.1028,23.2351},
        {24.7572,26.1599,24.6636,28.1244,23.6009,23.6009,17.0677,24.9259,24.0696,30.9964,17.0677,25.25},
        {17.0878,13.9994,19.6163,28.1244,15.2355,16.1782,18.3376,20.5984,22.1028,21.223,21.223,28.7629},
        {10.1992,6.9266,-113.8409,-113.8409,-113.8409,-113.8409,-113.8409,-113.8409,-113.8409,-113.8409,-113.8409,-113.8409},
        {5.0947,33.1565,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231},
        {4.6291,-111.4576,-111.4576,-111.4576,-111.4576,-211.4576,-111.4576,-111.4576,-111.4576,-111.4576,-111.4576,-111.4576},
        {-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109},
        {27.6529,7.6812,9.0223,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879},
        {0.8978,25.25,27.6529,30.1011,30.1011,18.0532,-203.5864,-103.5864,-103.5864,-103.5864,-103.5864,-103.5864},
        {26.953,25.25,25.7018,30.1011,23.9373,23.6009,25.25,25.9485,22.8387,22.5829,25.9485,26.5921},
        {27.2849,25.9485,26.5921,30.1011,30.9964,24.0696,24.1527,22.769,28.1244,24.7572,24.4909,26.1599},
        {23.6009,25.9485,25.9485,26.953,26.936,30.1011,25.9485,24.6636,27.2849,30.1011,30.9964,28.7629},
        {22.9669,24.9259,25.9485,33.1565,28.7629,27.2849,27.6529,24.9259,30.1011,17.0677,25.7018,21.223},
        {25.25,16.3872,19.6088,22.8387,26.1599,12.6871,25.1069,28.1244,19.6088,24.5945,24.6636,16.1094},
        {24.0696,15.7726,14.3871,16.1782,30.9964,17.0677,30.1011,20.2164,27.6529,22.0682,14.9051,-114.641},
        {11.2733,25.7968,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109},
        {-100.0551,-100.0551,-100.0551,-100.0551,-100.0551,-100.0551,-100.0551,-100.0551,-100.0551,-100.0551,-100.0551,-100.0551},
        {-101.8829,-101.8829,-101.8829,-101.8829,-101.8829,-101.8829,-101.8829,-101.8829,-101.8829,-101.8829,-101.8829,-101.8829},
        {-100.8231,-100.8231,-100.8231,-100.8231,-200.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231},
        {30.1011,-110.0265,-110.0265,-110.0265,-110.0265,-110.0265,-110.0265,-110.0265,-110.0265,-110.0265,-110.0265,-110.0265},
        {-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-200.8231,-100.8231},
        {-100.5097,-100.5097,-200.5097,-100.5097,-100.5097,-100.5097,-100.5097,-100.5097,-100.5097,-100.5097,-100.5097,-100.5097},
        {4.957,-108.7109,-108.7109,-108.7109,-108.7109,-208.7109,-108.7109,-108.7109,-208.7109,-108.7109,-108.7109,-108.7109},
        {23.6009,27.6529,33.1565,22.0682,25.25,23.6009,19.6318,25.25,24.4909,23.2351,25.7979,19.6088},
        {24.4909,23.6866,25.25,27.2849,32.4865,24.6636,25.7018,27.2849,30.9964,24.9259,24.4909,26.1599},
        {25.9485,23.8218,24.0696,25.25,30.5894,25.25,24.6636,26.5921,30.1011,24.4909,24.6636,25.25},
        {28.7629,28.7629,30.9964,25.9485,25.9485,28.7629,27.6529,32.4865,30.9964,30.5894,27.6529,24.9259},
        {17.0677,25.9485,23.6009,21.5327,23.6009,26.1599,30.9964,24.0696,17.0347,21.7338,21.223,22.8387},
        {-113.5187,-113.5187,-113.5187,-113.5187,-113.5187,-113.5187,-113.5187,-113.5187,-113.5187,-113.5187,-113.5187,-113.5187},
        {-112.6891,-112.6891,-112.6891,-112.6891,-112.6891,-112.6891,-112.6891,-112.6891,-112.6891,-112.6891,-112.6891,-112.6891},
        {-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879},
        {-203.6346,-103.6346,-103.6346,-103.6346,-103.6346,-103.6346,-103.6346,-103.6346,-103.6346,-103.6346,-103.6346,-103.6346},
        {-100.2378,-200.2378,-100.2378,-200.2378,-999,-999,-999,-999,-999,-999,-999,-999},
        {-198.1678,-999,-999,-999,-999,-999,-999,-999,-999,-999,-999,-999},
        {1.8847,-198.1678,-98.1678,-198.1678,-999,-999,-999,-999,-999,-999,-999,-999},
        {-201.6264,-999,-999,-999,-999,-999,-999,-999,-999,-999,-999,-999},
        {13.9457,-198.1678,-999,-999,-999,-999,-999,-999,-999,-999,-999,-999},
        {-198.1678,-999,-999,-999,-999,-999,-999,-999,-999,-999,-999,-999},
        {-1.8322,24.6636,-200.4831,-999,-999,-999,-999,-999,-999,-999,-999,-999},
        {NaN,NaN,NaN,-198.1678,-98.1678,-98.1678,-98.1678,-198.1678,-999,-999,-999,-999},
        {NaN,NaN,NaN,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231},
        {NaN,NaN,NaN,-1.8322,30.1011,-198.1678,-98.1678,-198.1678,-999,-999,-999,-999},
        {NaN,NaN,NaN,23.8218,25.25,28.7629,18.2311,26.6499,24.094,27.6529,30.9964,27.6529},
        {NaN,NaN,NaN,-199.9443,-99.9443,-99.9443,-99.9443,-99.9443,-199.9443,-999,-999,-999},   // !!
        {NaN,NaN,NaN,26.6499,25.9485,28.1244,24.9259,24.4909,23.2351,30.1011,30.9964,28.1244},
        {NaN,NaN,NaN,NaN,-99.9443,-199.9443,-999,-999,-999,-999,-999,-999},
        {NaN,NaN,NaN,NaN,27.2849,27.2849,22.0682,22.9669,30.1011,24.4909,10.0799,27.6529},
        {NaN,NaN,NaN,NaN,-100.8231,-100.8231,-100.8231,-200.8231,-100.8231,-100.8231,-100.8231,-100.8231},
        {NaN,NaN,NaN,NaN,7.3626,-105.9739,-105.9739,-105.9739,-105.9739,-105.9739,-105.9739,-105.9739},
        {NaN,NaN,NaN,NaN,-198.0428,-999,-999,-999,-999,-999,-999,-999},
        {NaN,NaN,NaN,NaN,NaN,30.1011,-1.8319,0.8479,1.8981,1.0302,30.1011,27.6529},
        {NaN,NaN,NaN,NaN,NaN,23.6009,22.1307,18.2311,-104.5879,-104.5879,-104.5879,-104.5879},
        {NaN,NaN,NaN,NaN,NaN,-198.1931,-999,-999,-999,-999,-999,-999},
        {NaN,NaN,NaN,NaN,NaN,-201.8829,-999,-999,-999,-999,-999,-999},
        {NaN,NaN,NaN,NaN,NaN,NaN,22.0682,30.1011,-113.1998,-113.1998,-113.1998,-113.1998},
        {NaN,NaN,NaN,NaN,NaN,NaN,-198.1678,-999,-999,-999,-999,-999},
        {NaN,NaN,NaN,NaN,NaN,NaN,0.2739,-200.056,-100.056,-200.056,-999,-999},
        {NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,27.6529,-198.1678,-999},
        {NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,28.7629,-1.8319,-210.0116},
        {NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,24.6636,28.7629,24.7572},
        {NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,4.2203,-100.8231},
        {NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,-198.1678,-999},
        {NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,-204.5879},
        {NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,27.2849}};

    Series a7_stable_21_e125_r1_v6 = {
        {23.8218,25.25,28.7629,21.223,23.6009,18.2556},
        {26.0395,24.6636,23.2762,30.1011,25.25,28.7629},
        {27.2849,25.25,25.25,24.4909,24.9259,27.6529},
        {28.7629,28.1244,27.6529,27.2849,30.1011,27.2849},
        {24.4909,26.953,19.6088,25.9485,17.9015,30.9964},
        {-112.0189,-112.0189,-112.0189,-112.0189,-112.0189,-112.0189},
        {25.1069,19.6088,12.3794,10.2571,18.0365,16.2469},
        {1.0302,10.7447,-111.1314,-111.1314,-111.1314,-111.1314},
        {17.0677,-113.5203,-113.5203,-113.5203,-113.5203,-113.5203},
        {10.0034,7.752,16.1782,-105.9739,-105.9739,-105.9739},
        {18.2311,24.6823,30.1011,24.4909,22.8387,25.25},
        {28.1244,26.5921,25.7018,26.0985,26.5921,26.5921},
        {25.9485,18.2311,25.7018,25.1069,24.4909,30.9964},
        {27.6529,22.0929,30.5894,25.1069,27.2849,24.6636},
        {24.7572,26.1599,24.6636,28.1244,23.6009,23.6009},
        {17.0878,13.9994,19.6163,28.1244,15.2355,16.1782},
        {10.1992,6.9266,-113.8409,-113.8409,-113.8409,-113.8409},
        {5.0947,33.1565,-100.8231,-100.8231,-100.8231,-100.8231},
        {4.6291,-111.4576,-111.4576,-111.4576,-111.4576,-211.4576},
        {-108.7109,-108.7109,-108.7109,-108.7109,-108.7109,-108.7109},
        {27.6529,7.6812,9.0223,-104.5879,-104.5879,-104.5879},
        {0.8978,25.25,27.6529,30.1011,30.1011,18.0532},
        {26.953,25.25,25.7018,30.1011,23.9373,23.6009},
        {27.2849,25.9485,26.5921,30.1011,30.9964,24.0696},
        {23.6009,25.9485,25.9485,26.953,26.936,30.1011},
        {22.9669,24.9259,25.9485,33.1565,28.7629,27.2849},
        {25.25,16.3872,19.6088,22.8387,26.1599,12.6871},
        {24.0696,15.7726,14.3871,16.1782,30.9964,17.0677},
        {11.2733,25.7968,-108.7109,-108.7109,-108.7109,-108.7109},
        {-100.0551,-100.0551,-100.0551,-100.0551,-100.0551,-100.0551},
        {-101.8829,-101.8829,-101.8829,-101.8829,-101.8829,-101.8829},
        {-100.8231,-100.8231,-100.8231,-100.8231,-200.8231,-100.8231},
        {30.1011,-110.0265,-110.0265,-110.0265,-110.0265,-110.0265},
        {-100.8231,-100.8231,-100.8231,-100.8231,-100.8231,-100.8231},
        {-100.5097,-100.5097,-200.5097,-100.5097,-100.5097,-100.5097},
        {4.957,-108.7109,-108.7109,-108.7109,-108.7109,-208.7109},
        {23.6009,27.6529,33.1565,22.0682,25.25,23.6009},
        {24.4909,23.6866,25.25,27.2849,32.4865,24.6636},
        {25.9485,23.8218,24.0696,25.25,30.5894,25.25},
        {28.7629,28.7629,30.9964,25.9485,25.9485,28.7629},
        {17.0677,25.9485,23.6009,21.5327,23.6009,26.1599},
        {-113.5187,-113.5187,-113.5187,-113.5187,-113.5187,-113.5187},
        {-112.6891,-112.6891,-112.6891,-112.6891,-112.6891,-112.6891},
        {-104.5879,-104.5879,-104.5879,-104.5879,-104.5879,-104.5879},
        {-203.6346,-103.6346,-103.6346,-103.6346,-103.6346,-103.6346},
        {-100.2378,-200.2378,-100.2378,-200.2378,-999,-999},
        {-198.1678,-999,-999,-999,-999,-999},
        {1.8847,-198.1678,-98.1678,-198.1678,-999,-999},
        {-201.6264,-999,-999,-999,-999,-999},
        {13.9457,-198.1678,-999,-999,-999,-999},
        {-198.1678,-999,-999,-999,-999,-999},
        {-1.8322,24.6636,-200.4831,-999,-999,-999},
        {NaN,NaN,NaN,-198.1678,-98.1678,-98.1678},
        {NaN,NaN,NaN,-100.8231,-100.8231,-100.8231},
        {NaN,NaN,NaN,-1.8322,30.1011,-198.1678},
        {NaN,NaN,NaN,23.8218,25.25,28.7629},
        {NaN,NaN,NaN,-199.9443,-99.9443,-99.9443},
        {NaN,NaN,NaN,26.6499,25.9485,28.1244},
        {NaN,NaN,NaN,NaN,-99.9443,-199.9443},
        {NaN,NaN,NaN,NaN,27.2849,27.2849},
        {NaN,NaN,NaN,NaN,-100.8231,-100.8231},
        {NaN,NaN,NaN,NaN,7.3626,-105.9739},
        {NaN,NaN,NaN,NaN,-198.0428,-999},
        {NaN,NaN,NaN,NaN,NaN,30.1011},
        {NaN,NaN,NaN,NaN,NaN,23.6009},
        {NaN,NaN,NaN,NaN,NaN,-198.1931},
        {NaN,NaN,NaN,NaN,NaN,-201.8829}};

    Series a_a7_stable_21_e125_r1_v6 = {
        {23.8218,25.25,28.7629,21.223,23.6009,18.2556},
        {26.0395,24.6636,23.2762,30.1011,25.25,28.7629},
        {27.2849,25.25,25.25,24.4909,24.9259,27.6529},
        {28.7629,28.1244,27.6529,27.2849,30.1011,27.2849},
        {24.4909,26.953,19.6088,25.9485,17.9015,30.9964},
        {NaN,NaN,NaN,26.6499,25.9485,28.1244},
        {25.1069,19.6088,12.3794,10.2571,18.0365,16.2469},
        {NaN,NaN,NaN,23.8218,25.25,28.7629},
        {17.0677,25.9485,23.6009,21.5327,23.6009,26.1599},
        {28.7629,28.7629,30.9964,25.9485,25.9485,28.7629},
        {18.2311,24.6823,30.1011,24.4909,22.8387,25.25},
        {28.1244,26.5921,25.7018,26.0985,26.5921,26.5921},
        {25.9485,18.2311,25.7018,25.1069,24.4909,30.9964},
        {27.6529,22.0929,30.5894,25.1069,27.2849,24.6636},
        {24.7572,26.1599,24.6636,28.1244,23.6009,23.6009},
        {17.0878,13.9994,19.6163,28.1244,15.2355,16.1782},
        {25.9485,23.8218,24.0696,25.25,30.5894,25.25},
        {24.4909,23.6866,25.25,27.2849,32.4865,24.6636},
        {23.6009,27.6529,33.1565,22.0682,25.25,23.6009},
        {24.0696,15.7726,14.3871,16.1782,30.9964,17.0677},
        {25.25,16.3872,19.6088,22.8387,26.1599,12.6871},
        {0.8978,25.25,27.6529,30.1011,30.1011,18.0532},
        {26.953,25.25,25.7018,30.1011,23.9373,23.6009},
        {27.2849,25.9485,26.5921,30.1011,30.9964,24.0696},
        {23.6009,25.9485,25.9485,26.953,26.936,30.1011},
        {22.9669,24.9259,25.9485,33.1565,28.7629,27.2849}};


/*
    @param s Series to test
    @param a Expected series after processing
    @param expected_p Expected minimum p
    @param expected_size Expected size of resulting series (should be nrow(a))
    @param header Header for output
*/
void tester(Series s, Series a, double expected_p, int expected_size, string header) {
    ArrestSeries *as = new ArrestSeries(s, ArrestSeries::ArrestProcessType::ARREST_WITH_PROBS);

    bool pass = abs(as->get_min_p() - expected_p) < 0.00001;
    pass &= as->get_series().size() == expected_size;
    
    if (pass)
        for(int i = 0 ; i < a.size() ; i++)
            for(int j = 0 ; j < a[i].size() ; j++)
                pass &= a[i][j] == as->get_series()[i][j];

    cout << "\n******\n" << header << (pass ?  "Pass" : "Fail") << endl;
    if (!pass) {
        cout << "Min p: " << as->get_min_p() << endl;
        cout << "Size as: " << as->get_series().size() << endl;
        print("s ", as->get_series());
        print("a ", a);
    }
    print("pr gys:", as->get_pr_gys());
    print("pr yrs:", as->get_pr_yrs());

}


int main() {
    tester(s1, a1, 1, 5, "s1 ");
    tester(s2, a2, 9.10979e-16, 4, "s2 ");
    tester(s3, a3, 1, 4, "s3 ");
    tester(s4, a4, 1, 0, "s4 ");
    tester(s5, a5, 0.00832307, 2, "s5 ");

    tester(s6, a5, 0.9, 0, "s6 ");

    tester(a7_stable_21_e101_r1, a_a7_stable_21_e101_r1, 0.0613947, 29, "e101 rep1 ");

    tester(a7_stable_21_e125_r1, a_a7_stable_21_e101_r1, 0.0613947, 29, "e125 rep1 visit 12");

    tester(a7_stable_21_e125_r1_v6, a_a7_stable_21_e101_r1, 0.506597, 29, "e125 rep1 visit 6");

    //vector<Eye> eyes = read_json("e101_a20_stab_r3_v6.json");
    vector<Eye> eyes = read_json("e99_a20_stab_r57_v12.json");
    //vector<Eye> eyes = read_json("e42_a20_prog_r15_v12.json");
    //vector<Eye> eyes = read_json("e97_a20_prog_r22_v12.json");
    //vector<Eye> eyes = read_json("e84_a20_prog_r9_v12.json");
    //vector<Eye> eyes = read_json("e53_a20_prog_r1_v12.json");
    for (Eye e : eyes)
        for (Series s : e) {
            //tester(s, a1, 1, 5, "e101 rep3 visit 6 ");
            tester(s, a1, 1, 5, "e99 rep57 visit 12");
            //tester(s, a1, 1, 5, "e42 rep15 visit 12");
            //tester(s, a1, 1, 5, "e97 rep22 visit 12");
            //tester(s, a1, 1, 5, "e84 rep9 visit 12");
            //tester(s, a1, 1, 5, "e53 rep1 visit 12");
        }

    ArrestSeries *as = new ArrestSeries(s5, ArrestSeries::ArrestProcessType::ARREST_WITH_PROBS);
    as->test();
    /*
    */

    return 0;
}